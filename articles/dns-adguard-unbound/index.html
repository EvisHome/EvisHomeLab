<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Eliminating reliance on third parties. Coupling AdGuard Home with Unbound.">
      
      
        <meta name="author" content="Evis">
      
      
        <link rel="canonical" href="https://www.evishome.com/articles/dns-adguard-unbound/">
      
      
        <link rel="prev" href="../bed-occupancy-sensor/">
      
      
        <link rel="next" href="../home-assistant-os-vm/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>DNS AdGuard Home &amp; Unbound - EvisHomeLab</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-Q3C6JS2Q46"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-Q3C6JS2Q46",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-Q3C6JS2Q46",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dns-the-adguard-home-unbound-stack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EvisHomeLab" class="md-header__button md-logo" aria-label="EvisHomeLab" data-md-component="logo">
      
  <img src="../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvisHomeLab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DNS AdGuard Home &amp; Unbound
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/EvisHome/EvisHomeLab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    EvisHome/EvisHomeLab
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EvisHomeLab" class="md-nav__button md-logo" aria-label="EvisHomeLab" data-md-component="logo">
      
  <img src="../../assets/images/favicon.png" alt="logo">

    </a>
    EvisHomeLab
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EvisHome/EvisHomeLab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    EvisHome/EvisHomeLab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device Inventory
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai-log-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Log Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../area-occupancy-sensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Area Occupancy Sensor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bed-occupancy-sensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bed Occupancy Sensor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    DNS AdGuard Home &amp; Unbound
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS AdGuard Home &amp; Unbound
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Architecture Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Architecture Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-split-brain-dns-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        The "Split-Brain" DNS Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visual Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-component-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Component Breakdown
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Component Breakdown">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-the-hardware-level-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. The Hardware Level (High Availability)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-the-software-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. The Software Stack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-the-boot-loop-protection-ntp" class="md-nav__link">
    <span class="md-ellipsis">
      
        C. The "Boot-Loop" Protection (NTP)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-the-ubuntu-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Preparing the Ubuntu Server
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-docker-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Docker Directories
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-docker-networks-in-portainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Docker Networks (in Portainer)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-unbound-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Unbound Configuration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unbound-portainer-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unbound Portainer Stack
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adguard-portainer-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adguard Portainer Stack
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adguard-home-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        AdGuard Home settings
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdGuard Home settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Settings
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unifi-network-dns-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Network DNS Configurations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unifi Network DNS Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-between-the-dns-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        Differences between the DNS settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-internet-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Internet DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-network-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Network DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-ip-group-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi IP Group DNS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting &amp; Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting &amp; Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-client-name-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        The "Client Name" Test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-fails" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain fails
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motorized-blinds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motorized Horizontal Blinds - Tilt Action
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../philips-hue-motion-sensor-mount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Philips Hue Motion Sensor Wall Mount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../self-healing-tailscale-nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Healing Tailscale Nodes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tinkercad-project-box-creator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TinkerCad Project Box Creator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../virtual-fireplace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virtual Fireplace
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_11">
        
          
          <label class="md-nav__link" for="__nav_3_11" id="__nav_3_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Ai log summary
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ai log summary
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai-log-summary/home-lab-logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home lab logs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai-log-summary/unraid-syslog-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unraid syslog server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../home-lab/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Home lab
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home lab
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Planning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Planning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../planning/ai_roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Automation Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../smart-home/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Smart home
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Smart home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/automations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UI Automations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration &amp; Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../smart-home/addons/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Addons
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Addons
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/addons/frigate_nvr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Frigate NVR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../smart-home/dashboards/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Dashboards
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dashboards
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_2">
        
          
          <label class="md-nav__link" for="__nav_6_5_2" id="__nav_6_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Admin system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Admin system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/admin-system/system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_3">
        
          
          <label class="md-nav__link" for="__nav_6_5_3" id="__nav_6_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Area automations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Area automations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/area-automations/room_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Room Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_4">
        
          
          <label class="md-nav__link" for="__nav_6_5_4" id="__nav_6_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Area manager
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Area manager
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/area-manager/room_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Room Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_5">
        
          
          <label class="md-nav__link" for="__nav_6_5_5" id="__nav_6_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dashboard persons
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dashboard persons
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/dashboard-persons/car/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CAR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/dashboard-persons/evis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/dashboard-persons/guest_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guest-1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_6">
        
          
          <label class="md-nav__link" for="__nav_6_5_6" id="__nav_6_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home access
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home access
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/home-access/home_access_center/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home Access Center
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_7">
        
          
          <label class="md-nav__link" for="__nav_6_5_7" id="__nav_6_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Main
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Main
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/backyard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backyard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/bathroom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bathroom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/bedroom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bedroom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/daughter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Daughter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/electricity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Electricity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/electricity_dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Electricity Dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/front_door/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Front Door
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/guest_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guest-2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/guest_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guest-3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/hallway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hallway
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/kitchen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kitchen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/living_room/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Living Room
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/lobby/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lobby
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/mud_room/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mud Room
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/office/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Office
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/sauna/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sauna
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/stairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stairs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/main/toilet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Toilet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_8">
        
          
          <label class="md-nav__link" for="__nav_6_5_8" id="__nav_6_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notification center
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notification center
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/notification-center/notification_builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notification Builder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/notification-center/notifications_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notifications Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_9">
        
          
          <label class="md-nav__link" for="__nav_6_5_9" id="__nav_6_5_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Room management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Room management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/room-management/room_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Room Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_10">
        
          
          <label class="md-nav__link" for="__nav_6_5_10" id="__nav_6_5_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Smart speakers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Smart speakers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/dashboards/smart-speakers/smart_speakers_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Smart Speakers Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../smart-home/integrations/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/integrations/ai_reporter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration: AI Log Reporter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../smart-home/packages/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Packages
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Packages
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/ai_summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Ai Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/airthings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Airthings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/aqara_w500/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Aqara W500
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/area_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Area Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/car/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Car
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/debug_script/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Debug Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/dishwasher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Dishwasher
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/dna_tv_hub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Dna Tv Hub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/fireplace_automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Fireplace Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/garmin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Garmin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/home_time_modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Home Time Modes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/nordpool_prices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Nordpool Prices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/office_pc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Office Pc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/philips_air_purifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Philips Air Purifier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/room_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Room Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/scenes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Scenes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/shelly_3em/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Shelly 3Em
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/smart_notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Smart Notifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/smart_speakers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Smart Speakers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/tailscale_edge_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Tailscale Edge Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/tailscale_halo_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Tailscale Halo Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/tailscale_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Tailscale Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/unifi_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Unifi Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smart-home/packages/washing_machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package: Washing Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../workflow/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Workflow
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/setup_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Architecture Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Architecture Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-split-brain-dns-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        The "Split-Brain" DNS Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visual Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-component-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Component Breakdown
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Component Breakdown">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-the-hardware-level-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. The Hardware Level (High Availability)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-the-software-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. The Software Stack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-the-boot-loop-protection-ntp" class="md-nav__link">
    <span class="md-ellipsis">
      
        C. The "Boot-Loop" Protection (NTP)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-the-ubuntu-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Preparing the Ubuntu Server
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-docker-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Docker Directories
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-docker-networks-in-portainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Docker Networks (in Portainer)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-unbound-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare Unbound Configuration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unbound-portainer-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unbound Portainer Stack
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adguard-portainer-stack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adguard Portainer Stack
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adguard-home-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        AdGuard Home settings
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdGuard Home settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Settings
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unifi-network-dns-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Network DNS Configurations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unifi Network DNS Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-between-the-dns-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        Differences between the DNS settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-internet-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Internet DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-network-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi Network DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifi-ip-group-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unifi IP Group DNS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting &amp; Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting &amp; Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-client-name-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        The "Client Name" Test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-fails" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain fails
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags">
    
      
      
      
      
        <a href="../../tags/#tag:adguard" class="md-tag">adguard</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:dns" class="md-tag">dns</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:self-hosted" class="md-tag">self-hosted</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:unbound" class="md-tag">unbound</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:unifi-network" class="md-tag">unifi-network</a>
      
    
  </nav>


  
  


<h1 id="dns-the-adguard-home-unbound-stack">DNS: The AdGuard Home &amp; Unbound Stack</h1>
<p>In this section, we break down the DNS architecture of the Homelab.</p>
<p>The goal is simple: Eliminate reliance on third parties. By coupling AdGuard Home (The Network Shield) with Unbound (The Recursive Resolver), we stop "asking" Google or our ISP for website addresses and start finding them ourselves directly from the global Root Servers.</p>
<p><br></p>
<p><strong>Key Takeaways</strong></p>
<ul>
<li>
<p>What this HIDES: Your full DNS query log from Google, Cloudflare, and your ISP's DNS Server. (Unless Unbound fails to respond for 10 seconds, it will use the Emergency Fallback)</p>
</li>
<li>
<p>What this DOES NOT HIDE: Your IP traffic from your ISP. (You would need a VPN for that).</p>
</li>
<li>
<p>What this PROTECTS: You are protected from DNS Censorship, DNS Spoofing, and "Typo-Squatting" ads often injected by ISPs.</p>
</li>
</ul>
<p><br></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/adguard-home.png" data-desc-position="bottom"><img alt="adguard-home" src="../dns-adguard-unbound/adguard-home.png"></a></p>
<h2 id="1-architecture-overview">1. Architecture Overview</h2>
<h3 id="the-split-brain-dns-model">The "Split-Brain" DNS Model</h3>
<p>This system relies on a Decoupled Architecture:</p>
<ol>
<li>
<p>The Shield (AdGuard Home): Handles request filtering, blocklists, and client management. It acts as the "doorman."</p>
</li>
<li>
<p>The Resolver (Unbound): Handles the actual "phone book" lookup. It talks directly to the global Root Servers, avoiding the use of Google (8.8.8.8) or your ISP's DNS servers for resolution.</p>
</li>
</ol>
<h3 id="visual-diagram">Visual Diagram</h3>
<p></p><pre class="mermaid"><code>flowchart TD
    %% -- Subgraph: The Network Clients --
    subgraph LAN [" Home Network (VLANs)"]
        Client1[(" Phone / PC")]
        Client2[(" IoT / TV")]
    end

    %% -- Subgraph: The Router --
    subgraph Router ["UniFi Dream Machine (UDM Pro)"]
        DHCP[(" DHCP Server ")]
    end

    %% -- Subgraph: High Availability Cluster --
    subgraph DNS_Cluster [" DNS High Availability Cluster"]
        direction TB

        subgraph Node1 ["Raspberry Pi 63 (Primary)"]
            AGH1[" AdGuard Home (:53)"]
            Unbound1[" Unbound (:5335)"]
            AGH1 --&gt;|Recursive Query| Unbound1
        end

        subgraph Node2 ["Raspberry Pi 62 (Secondary)"]
            AGH2[" AdGuard Home (:53)"]
            Unbound2[" Unbound (:5335)"]
            AGH2 --&gt;|Recursive Query| Unbound2
        end
    end

    %% -- Subgraph: The Internet --
    subgraph Internet [" The Internet"]
        RootServers["ROOT Servers &lt;br&gt; (ICANN / Verisign)"]
        Quad9[" Public Servers &lt;br&gt; (Emergency Fallback)"]
    end

    %% -- Connections --
    %% 1. DHCP Assignment
    DHCP -- "Assigns DNS 1: Pi 63 &lt;br&gt; Assigns DNS 2: Pi 62" --&gt; LAN

    %% 2. Client Requests (Load Balanced by Client OS)
    LAN -- "DNS Query (Primary)" --&gt; AGH1
    LAN -- "DNS Query (Backup)" --&gt; AGH2

    %% 3. Unbound Recursive Lookup (Privacy Path)
    Unbound1 -- "Direct Recursive Lookup &lt;br&gt; (No Middleman)" --&gt; RootServers
    Unbound2 -- "Direct Recursive Lookup &lt;br&gt; (No Middleman)" --&gt; RootServers

    %% 4. The Safety Net (Fail-Safe) - FIXED QUOTES BELOW
    AGH1 -.-&gt;|"Timeout &gt; Safety Net"| Quad9
    AGH2 -.-&gt;|"Timeout &gt; Safety Net"| Quad9

    %% Styling

    style DNS_Cluster fill:#2deb49,stroke:#01579b,stroke-width:2px
    style Node1 fill:#111111,stroke:#01579b,stroke-width:2px
    style Node2 fill:#111111,stroke:#01579b,stroke-width:2px
    style Quad9 fill:#610c06,stroke:#b71c1c,stroke-dasharray: 5 5
    style RootServers fill:#066114,stroke:#2e7d32</code></pre>
<br>
<br><p></p>
<h2 id="2-component-breakdown">2. Component Breakdown</h2>
<h3 id="a-the-hardware-level-high-availability">A. The Hardware Level (High Availability)</h3>
<p>We utilize <strong>two physical Raspberry Pis</strong> (10.0.0.63 and 10.0.0.62).</p>
<ul>
<li>
<p>Why: If one Pi crashes, updates, or needs a reboot, the internet does not stop.</p>
</li>
<li>
<p>Distribution: The UniFi UDM Pro is configured via DHCP to hand out both IP addresses to every device on the network.</p>
</li>
<li>
<p>Client Logic: Modern devices automatically failover to the second IP if the first one doesn't answer (~1000ms), ensuring seamless uptime.</p>
</li>
</ul>
<h3 id="b-the-software-stack">B. The Software Stack</h3>
<p>Each Pi runs an identical Docker stack:</p>
<p><strong>1. AdGuard Home (The Frontend)</strong></p>
<ul>
<li>
<p>Role: Blocks Ads, Trackers, and Malware.</p>
</li>
<li>
<p>Load Balancing: Functionally sends 100% of traffic to the local Unbound container (via "Load Balance" mode).</p>
</li>
<li>
<p>Safety Net: Configured with an Emergency Fallback (9.9.9.9) that activates only if Unbound fails to respond for 10 seconds.</p>
</li>
</ul>
<p><strong>2. Unbound (The Backend)</strong></p>
<ul>
<li>
<p>Role: Recursive Resolver.</p>
</li>
<li>
<p>Privacy: It bypasses Centralized DNS Loggers (like Google or Cloudflare). No single company creates a profile of your DNS history.</p>
</li>
<li>
<p>Nuance: Your ISP can still see the destination IPs and SNI (Server Name Indication) of sites you visit, but they cannot manipulate or spoof your DNS results.</p>
</li>
<li>
<p>Security: Handles DNSSEC validation locally. If a site signature is fake, Unbound returns SERVFAIL before AdGuard even sees the IP.</p>
</li>
</ul>
<h3 id="c-the-boot-loop-protection-ntp">C. The "Boot-Loop" Protection (NTP)</h3>
<ul>
<li>
<p><strong>Problem:</strong> Pis lack an RTC battery. If they reboot without internet, they revert to 1970, breaking DNSSEC validation (deadlock).</p>
</li>
<li>
<p><strong>Solution:</strong> Chrony is configured to use Raw IP Addresses (Google/Cloudflare NTP) instead of hostnames. This ensures the Pi gets the correct time immediately at boot, allowing Unbound to start securely.</p>
</li>
</ul>
<p><br>
<br></p>
<h2 id="preparing-the-ubuntu-server">Preparing the Ubuntu Server</h2>
<p>If you just try to start the Adguard docker container you will probably run in to few problems:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Failed to bind port 0.0.0.0:53/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:53: bind: address already in use</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>DNS Port 53 being already in use. This is because the operating system has it reserved.</p>
</div>
<p><strong>Edit etc/systemd/resolved.conf</strong>
</p><div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/systemd/resolved.conf

<span class="c1"># Uncomment DNSStubListener and set it to no</span>
<span class="nv">DNSStubListener</span><span class="o">=</span>no
</code></pre></div>
Press CTRL + x and then press y to save the changes<p></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/run/systemd/resolve/stub-resolv.conf<span class="w"> </span>/etc/resolv.conf
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-resolved
</code></pre></div>
<h2 id="prepare-docker-directories">Prepare Docker Directories</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure the directory mapped to /opt/adguardhome/work\ has rights 0700 | Otherwise your settings are not stored, and when restarted you need to reconfigure.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
<span class="nb">cd</span><span class="w"> </span>docker
sudo<span class="w"> </span>mkdir<span class="w"> </span>adguard

sudo<span class="w"> </span>mkdir<span class="w"> </span>adguard/conf
sudo<span class="w"> </span>mkdir<span class="w"> </span>adguard/work

<span class="c1">#sudo touch adguard/confdir/AdGuardHome.yaml</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">0700</span><span class="w"> </span>adguard/work
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">0700</span><span class="w"> </span>adguard/conf

sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>evis:docker<span class="w"> </span>adguard/work
sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>evis:docker<span class="w"> </span>adguard/conf
</code></pre></div>
<p><br>
<br></p>
<h2 id="prepare-docker-networks-in-portainer">Prepare Docker Networks (in Portainer)</h2>
<p>Create the Networks in Portainer</p>
<ul>
<li>dns_net | will used to put Adguard Home and Unbound DNS server to same network so they can connect. When Adguard is using Unbound as the DNS server.</li>
<li>proxy | this can be used with Traefik Reverse Proxy (if using Traefik)</li>
</ul>
<p><strong>dns_net Network</strong></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/dns_net.png" data-desc-position="bottom"><img alt="dns_net Network" src="../dns-adguard-unbound/dns_net.png"></a></p>
<p><br>
<br></p>
<h2 id="prepare-unbound-configuration">Prepare Unbound Configuration</h2>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/docker/unbound/unbound.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code>server:
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># BASIC SETTINGS</span>
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># Standard Port 53 (Mapped to 5053 via Docker Compose)</span>
<span class="w">    </span>interface:<span class="w"> </span><span class="m">0</span>.0.0.0@53
<span class="w">    </span>port:<span class="w"> </span><span class="m">53</span>

<span class="w">    </span><span class="c1"># Protocol Support</span>
<span class="w">    </span><span class="k">do</span>-ip4:<span class="w"> </span>yes
<span class="w">    </span><span class="k">do</span>-ip6:<span class="w"> </span>yes
<span class="w">    </span><span class="k">do</span>-tcp:<span class="w"> </span>yes
<span class="w">    </span><span class="k">do</span>-udp:<span class="w"> </span>yes
<span class="w">    </span>prefer-ip6:<span class="w"> </span>no

<span class="w">    </span><span class="c1"># Optimization</span>
<span class="w">    </span>edns-buffer-size:<span class="w"> </span><span class="m">1232</span>
<span class="w">    </span>rrset-roundrobin:<span class="w"> </span>yes
<span class="w">    </span>username:<span class="w"> </span><span class="s2">"_unbound"</span>

<span class="w">    </span><span class="c1"># Directory</span>
<span class="w">    </span>directory:<span class="w"> </span><span class="s2">"/opt/unbound/etc/unbound"</span>
<span class="w">    </span>cache-max-ttl:<span class="w"> </span><span class="m">86400</span>
<span class="w">    </span>cache-min-ttl:<span class="w"> </span><span class="m">300</span>

<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># LOGGING (Promtail Ready)</span>
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># Disable internal file logging -&gt; Send to Stdout for Docker/Promtail</span>
<span class="w">    </span>log-local-actions:<span class="w"> </span>no
<span class="w">    </span>log-queries:<span class="w"> </span>no
<span class="w">    </span>log-replies:<span class="w"> </span>no
<span class="w">    </span>log-servfail:<span class="w"> </span>no

<span class="w">    </span>logfile:<span class="w"> </span><span class="s2">""</span><span class="w">        </span><span class="c1"># Force stdout</span>
<span class="w">    </span>use-syslog:<span class="w"> </span>no
<span class="w">    </span>verbosity:<span class="w"> </span><span class="m">2</span><span class="w">       </span><span class="c1"># Level 2 gives us the stats we need for Grafana</span>

<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># PERFORMANCE (Tuned for 8GB Raspberry Pi)</span>
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># Use all 4 cores</span>
<span class="w">    </span>num-threads:<span class="w"> </span><span class="m">4</span>

<span class="w">    </span><span class="c1"># Slabs (Must be power of 2)</span>
<span class="w">    </span>infra-cache-slabs:<span class="w"> </span><span class="m">4</span>
<span class="w">    </span>key-cache-slabs:<span class="w"> </span><span class="m">4</span>
<span class="w">    </span>msg-cache-slabs:<span class="w"> </span><span class="m">4</span>
<span class="w">    </span>rrset-cache-slabs:<span class="w"> </span><span class="m">4</span>

<span class="w">    </span><span class="c1"># Cache Sizes (High Performance - Uses ~2GB RAM total)</span>
<span class="w">    </span>msg-cache-size:<span class="w"> </span>256m
<span class="w">    </span>rrset-cache-size:<span class="w"> </span>512m

<span class="w">    </span><span class="c1"># TCP &amp; Queries</span>
<span class="w">    </span>outgoing-range:<span class="w"> </span><span class="m">8192</span>
<span class="w">    </span>num-queries-per-thread:<span class="w"> </span><span class="m">4096</span>
<span class="w">    </span>incoming-num-tcp:<span class="w"> </span><span class="m">10</span>

<span class="w">    </span><span class="c1"># Speed Tweaks</span>
<span class="w">    </span>minimal-responses:<span class="w"> </span>yes
<span class="w">    </span>prefetch:<span class="w"> </span>yes
<span class="w">    </span>prefetch-key:<span class="w"> </span>yes
<span class="w">    </span>serve-expired:<span class="w"> </span>yes
<span class="w">    </span>so-reuseport:<span class="w"> </span>yes

<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># SECURITY &amp; PRIVACY</span>
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># Access Control (Allow Local Network)</span>
<span class="w">    </span>access-control:<span class="w"> </span><span class="m">127</span>.0.0.1/32<span class="w"> </span>allow
<span class="w">    </span>access-control:<span class="w"> </span><span class="m">192</span>.168.0.0/16<span class="w"> </span>allow
<span class="w">    </span>access-control:<span class="w"> </span><span class="m">172</span>.16.0.0/12<span class="w"> </span>allow
<span class="w">    </span>access-control:<span class="w"> </span><span class="m">10</span>.0.0.0/8<span class="w"> </span>allow
<span class="w">    </span>access-control:<span class="w"> </span>fc00::/7<span class="w"> </span>allow
<span class="w">    </span>access-control:<span class="w"> </span>::1/128<span class="w"> </span>allow

<span class="w">    </span><span class="c1"># Privacy</span>
<span class="w">    </span>hide-identity:<span class="w"> </span>yes
<span class="w">    </span>hide-version:<span class="w"> </span>yes
<span class="w">    </span>identity:<span class="w"> </span><span class="s2">"DNS"</span>
<span class="w">    </span>http-user-agent:<span class="w"> </span><span class="s2">"DNS"</span>
<span class="w">    </span>qname-minimisation:<span class="w"> </span>yes
<span class="w">    </span>aggressive-nsec:<span class="w"> </span>yes

<span class="w">    </span><span class="c1"># Hardening</span>
<span class="w">    </span>harden-algo-downgrade:<span class="w"> </span>yes
<span class="w">    </span>harden-below-nxdomain:<span class="w"> </span>yes
<span class="w">    </span>harden-dnssec-stripped:<span class="w"> </span>yes
<span class="w">    </span>harden-glue:<span class="w"> </span>yes
<span class="w">    </span>harden-large-queries:<span class="w"> </span>yes
<span class="w">    </span>harden-short-bufsize:<span class="w"> </span>yes
<span class="w">    </span>use-caps-for-id:<span class="w"> </span>yes

<span class="w">    </span><span class="c1"># Private Addresses (Rebinding Protection)</span>
<span class="w">    </span>private-address:<span class="w"> </span><span class="m">10</span>.0.0.0/8
<span class="w">    </span>private-address:<span class="w"> </span><span class="m">172</span>.16.0.0/12
<span class="w">    </span>private-address:<span class="w"> </span><span class="m">192</span>.168.0.0/16
<span class="w">    </span>private-address:<span class="w"> </span><span class="m">169</span>.254.0.0/16
<span class="w">    </span>private-address:<span class="w"> </span>fd00::/8
<span class="w">    </span>private-address:<span class="w"> </span>fe80::/10

<span class="w">    </span><span class="c1"># Certificates</span>
<span class="w">    </span>tls-cert-bundle:<span class="w"> </span>/etc/ssl/certs/ca-certificates.crt

<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># INCLUDES</span>
<span class="w">    </span><span class="c1">###########################################################################</span>
<span class="w">    </span><span class="c1"># Only include custom conf files if you create them manually</span>
<span class="w">    </span><span class="c1">#include: "*.conf"</span>

<span class="w">    </span>domain-insecure:<span class="w"> </span><span class="s2">"valoo.fi"</span>

remote-control:
<span class="w">    </span>control-enable:<span class="w"> </span>no


<span class="c1"># Forward Zone for Valoo (Bypass local validation)</span>
forward-zone:
<span class="w">    </span>name:<span class="w"> </span><span class="s2">"valoo.fi"</span>
<span class="w">    </span>forward-dnssec:<span class="w"> </span>no
<span class="w">    </span>forward-addr:<span class="w"> </span><span class="m">9</span>.9.9.9
<span class="w">    </span>forward-addr:<span class="w"> </span><span class="m">1</span>.1.1.1
</code></pre></div>
<p><br>
<br></p>
<h2 id="unbound-portainer-stack">Unbound Portainer Stack</h2>
<div class="highlight"><pre><span></span><code><span class="c1">## NETWORKS ##</span>
<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="c1">## dns_net network between Adguard Home and Unbound</span>
<span class="w">  </span><span class="nt">dns_net</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns_net</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span><span class="w"> </span><span class="c1"># Using bridge driver for possible VPN solution</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.23.0.0/16</span>


<span class="c1">## SERVICES ##</span>
<span class="nt">services</span><span class="p">:</span>

<span class="w">  </span><span class="nt">unbound</span><span class="p">:</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unbound</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mvance/unbound-rpi:latest</span><span class="w"> </span><span class="c1"># Raspberry Pi version</span>
<span class="w">    </span><span class="c1">#image: mvance/unbound:latest # Non ARM version</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dns_net</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.23.0.8</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TZ=Europe/Helsinki</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/docker/unbound:/opt/unbound/etc/unbound</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5053:53/tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5053:53/udp</span>
<span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span>
<span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">"NONE"</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</code></pre></div>
<p><br>
<br></p>
<h2 id="adguard-portainer-stack">Adguard Portainer Stack</h2>
<p></p><div class="highlight"><pre><span></span><code><span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dns_net</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns_net</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.23.0.0/16</span>
<span class="w">  </span><span class="nt">proxy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>


<span class="nt">services</span><span class="p">:</span>

<span class="w">  </span><span class="nt">adguardhome</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">adguard/adguardhome</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">adguard-home</span>
<span class="w">    </span><span class="nt">security_opt</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-new-privileges:true</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dns_net</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.23.0.7</span>
<span class="w">      </span><span class="nt">proxy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># DNScrypt:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5443:5443/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5443:5443/tcp</span>
<span class="w">      </span><span class="c1"># DNS-over-QUIC:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8853:8853/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">853:853/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">784:784/udp</span>
<span class="w">      </span><span class="c1"># DNS-over-TLS</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">853:853/tcp</span>
<span class="w">      </span><span class="c1"># Home Admin Panel &amp; HTTPS/DNS-over-HTTPS:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3000:3000/tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443:443/udp</span>
<span class="w">      </span><span class="c1">#- 443:443/tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080:8080/tcp</span>
<span class="w">      </span><span class="c1"># DHCP server:</span>
<span class="w">      </span><span class="c1">#- 68:68/udp</span>
<span class="w">      </span><span class="c1">#- 67:67/udp</span>
<span class="w">      </span><span class="c1"># Plain DNS:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/tcp</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TZ=Europe/Helsinki</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/docker/adguard/conf:/opt/adguardhome/conf</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/docker/adguard/work:/opt/adguardhome/work</span>
</code></pre></div>
<br>
<br><p></p>
<h2 id="adguard-home-settings">AdGuard Home settings</h2>
<h3 id="dns-settings">DNS Settings</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Setting</th>
<th>Status / Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upstream DNS Servers</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><br></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Upstream DNS Servers</td>
<td>[/10.in-addr.arpa/]10.0.0.1<br> unbound:53</td>
<td>Rule: force local names to Router. <br> Everything else to Unbound.</td>
</tr>
<tr>
<td>Upstream Mode</td>
<td>Load Balancing</td>
<td>Using Load-balancing instead of "Parallel requests." Parallel requests would be useless with a single Unbound instance. Functionally is zero right now.</td>
</tr>
<tr>
<td>Fallback DNS servers</td>
<td>https://dns.quad9.net/dns-query <br> https://dns.google/dns-query</td>
<td>Encrypted (DoH) safety net. If Unbound dies, these keep internet alive if Unbound crashes. Unbound times out, AdGuard immediately routes traffic to public DNS servers</td>
</tr>
<tr>
<td>Bootstrap DNS</td>
<td>127.0.0.11 <br> 9.9.9.9 <br> 1.1.1.1 <br> 8.8.8.8</td>
<td>Configuration Safety. Essential for startup connectivity. With current setup only 127.0.0.11 is used for local Docker container lookups</td>
</tr>
<tr>
<td>Private DNS Servers</td>
<td>10.0.0.1</td>
<td>Pointing to Router (UDM Pro). AdGuard explicitly asks the UDM Pro for local lookups</td>
</tr>
<tr>
<td>Use Private DNS Resolvers</td>
<td> Checked</td>
<td>Crucial. Tells AdGuard to actually use the Router (UDM Pro) IP above for the lookups.</td>
</tr>
<tr>
<td>Enable Reverse Resolving of clients' IP addresses</td>
<td> Checked</td>
<td>Allows you to see names in logs (from UDM Pro).</td>
</tr>
<tr>
<td>Upstream timeout</td>
<td>10</td>
<td>Crucial for Unbound. Recursive lookups take longer (walking the chain from Root servers). 10s prevents AdGuard from giving up prematurely on "cold" queries.</td>
</tr>
<tr>
<td><br></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>DNS Sserver configuration</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><br></td>
<td></td>
</tr>
<tr>
<td>Rate Limit</td>
<td>0</td>
<td>Crucial. Unchecks the limit to prevent lag on heavy sites.</td>
</tr>
<tr>
<td>Enable DNSSEC</td>
<td> Unchecked</td>
<td>DNSSEC is handled by Unbound. Prevents packet fragmentation errors.</td>
</tr>
<tr>
<td>EDNS Client Subnet</td>
<td> Unchecked</td>
<td>Prevents buffer size errors.</td>
</tr>
<tr>
<td>Disable resolving of IPv6 addresses</td>
<td> Check this box</td>
<td>(Missed in Screenshot) Forces IPv4 for snappier browsing.</td>
</tr>
<tr>
<td>Blocking Mode</td>
<td>Null IP</td>
<td>Returns 0.0.0.0 for ads (Safest method).</td>
</tr>
<tr>
<td><br></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>DNS cache configuration</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><br></td>
<td></td>
</tr>
<tr>
<td>Enable Cache</td>
<td> Enabled</td>
<td>Enabled for speed.</td>
</tr>
<tr>
<td>Cache size</td>
<td>10000000</td>
<td>Set size to 10MB for speed.</td>
</tr>
<tr>
<td>Override minimum TTL</td>
<td>300</td>
<td>Tells AdGuard: "If a site says 'Ask me again in 30 seconds', ignore it and remember the answer for 5 minutes." This drastically quiets down your network traffic.</td>
</tr>
<tr>
<td>Override maximum TTL</td>
<td>86400</td>
<td>(86400s = 1 day) Refreshes data every day.</td>
</tr>
<tr>
<td>Optimistic Cache</td>
<td> Disabled</td>
<td>Ensures data freshness.</td>
</tr>
</tbody>
</table>
<p><br>
<br></p>
<h2 id="unifi-network-dns-configurations">Unifi Network DNS Configurations</h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>When changing DNS servers remember to check the following settings from Unifi Network Settings</p>
</div>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>Network DHCP clients should use the router (UDM) as the DNS server and then the below settings are applied in all cases.</p>
</div>
<h4 id="differences-between-the-dns-settings">Differences between the DNS settings</h4>
<ul>
<li>Internet - DNS server(s) that UDM or other gateway reaches out to for DNS results</li>
<li>Network - DNS server(s) that the DHCP server hands out to the clients on that network</li>
<li>IP Group - DNS server(s) used in the firewall rules</li>
</ul>
<h3 id="unifi-internet-dns">Unifi Internet DNS</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Internet DNS is used for all outbound traffic</p>
</div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/unifi-internet-dns.png" data-desc-position="bottom"><img alt="Unifi Internet DNS" src="../dns-adguard-unbound/unifi-internet-dns.png"></a></p>
<h3 id="unifi-network-dns">Unifi Network DNS</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Network DNS is used for all DHCP clients on the network</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only LAN network is using the Local DNS server, other networks like IoT and Company network are using public networks to avoid any blocking. Using AdGuard with some IoT devices like TV has created outage on some streaming applications e.g. Viaplay.</p>
</div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/unifi-network-dns.png" data-desc-position="bottom"><img alt="Unifi Network DNS" src="../dns-adguard-unbound/unifi-network-dns.png"></a></p>
<h3 id="unifi-ip-group-dns">Unifi IP Group DNS</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>IP Group DNS is used for all firewall rules</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>IP Group DNS is not used for DHCP clients on the network</p>
</div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/unifi-ip-group-dns1.png" data-desc-position="bottom"><img alt="Unifi IP Group DNS 1" src="../dns-adguard-unbound/unifi-ip-group-dns1.png"></a>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../dns-adguard-unbound/unifi-ip-group-dns2.png" data-desc-position="bottom"><img alt="Unifi IP Group DNS 2" src="../dns-adguard-unbound/unifi-ip-group-dns2.png"></a></p>
<p><br>
<br></p>
<h2 id="performance">Performance</h2>
<p>Because Unbound does the heavy lifting of traversing the DNS tree itself (instead of offloading it to a giant like Google), the performance metrics look different than a standard ISP setup.</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Target Value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Average Processing Time</td>
<td>~4060 ms</td>
<td>This is the "Privacy Tax." It is slightly higher than using Cloudflare directly (20ms), but it means you own the data.</td>
</tr>
<tr>
<td>Cache Hit Speed</td>
<td>&lt; 1 ms</td>
<td>Once a site is visited, AdGuard/Unbound serves it instantly from RAM.</td>
</tr>
<tr>
<td>Cold Lookup (New Site)</td>
<td>100200 ms</td>
<td>The first time you visit a rare site, Unbound must query the Root Servers. This happens once, then it is cached.</td>
</tr>
</tbody>
</table>
<p><br>
<br></p>
<h2 id="troubleshooting-testing">Troubleshooting &amp; Testing</h2>
<h3 id="the-client-name-test">The "Client Name" Test</h3>
<p>We ran this command to confirm the UDM Pro was correctly resolving local names:</p>
<div class="highlight"><pre><span></span><code>dig<span class="w"> </span>-x<span class="w"> </span><span class="m">10</span>.0.0.189<span class="w"> </span>@10.0.0.63
</code></pre></div>
<h3 id="domain-fails">Domain fails</h3>
<p>Check that the domain actually exists:</p>
<div class="highlight"><pre><span></span><code>nslookup<span class="w"> </span>oma.valoo.fi<span class="w"> </span><span class="m">8</span>.8.8.8
</code></pre></div>
<p>If it does exist, you can add it to the <strong>unbound.conf</strong> on all DNS servers.</p>
<p>Edit <strong>unbound.conf</strong> on all DNS servers
</p><div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/docker/unbound/unbound.conf
</code></pre></div><p></p>
<p>add to the bottom of the <strong>server:</strong> block</p>
<div class="highlight"><pre><span></span><code><span class="nt">server</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># ... other settings ...</span>
<span class="w">    </span><span class="nt">domain-insecure</span><span class="p">:</span><span class="w"> </span><span class="s">"valoo.fi"</span>


<span class="c1"># add to the bottom of the file</span>
<span class="nt">forward-zone</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"valoo.fi."</span>
<span class="w">    </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
<span class="w">    </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
</code></pre></div>
<p>Restart Unbound:
</p><div class="highlight"><pre><span></span><code>docker<span class="w"> </span>restart<span class="w"> </span>unbound
</code></pre></div><p></p>
<p>Test with:
</p><div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>adguard-home<span class="w"> </span>nslookup<span class="w"> </span>oma.valoo.fi<span class="w"> </span><span class="m">127</span>.0.0.1
</code></pre></div><p></p>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2026 EvisHome
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better. We use Google Analytics to collect anonymous usage data.</p>
<input class="md-toggle" type="checkbox" id="__settings">
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics">
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.indexes"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>